'use client'\n\nimport React, { useState } from 'react'\nimport { BirthDataForm } from '@/components/astrology/BirthDataForm'\nimport { BirthChartWheel } from '@/components/astrology/BirthChartWheel'\nimport { astrologyCalculator } from '@/lib/astrology/calculator'\nimport { BirthData, BirthChart } from '@/types/astrology'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { cn } from '@/lib/utils'\nimport { \n  StarIcon, \n  MoonIcon, \n  SunIcon, \n  SparklesIcon,\n  CalendarIcon,\n  MapPinIcon,\n  ClockIcon\n} from 'lucide-react'\n\nexport default function HomePage() {\n  const [birthChart, setBirthChart] = useState<BirthChart | null>(null)\n  const [isCalculating, setIsCalculating] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n\n  const handleBirthDataSubmit = async (birthData: BirthData) => {\n    setIsCalculating(true)\n    setError(null)\n\n    try {\n      // Initialize calculator if not already done\n      await astrologyCalculator.initialize()\n      \n      // Calculate birth chart\n      const result = await astrologyCalculator.calculateBirthChart(birthData)\n      \n      if (result.success && result.data) {\n        setBirthChart(result.data)\n      } else {\n        setError(result.error || 'Failed to calculate birth chart')\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'An unexpected error occurred')\n    } finally {\n      setIsCalculating(false)\n    }\n  }\n\n  const resetChart = () => {\n    setBirthChart(null)\n    setError(null)\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-purple-900 dark:to-indigo-900\">\n      {/* Header */}\n      <header className=\"border-b bg-white/80 backdrop-blur-sm dark:bg-gray-900/80\">\n        <div className=\"container mx-auto px-4 py-6\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"relative\">\n                <StarIcon className=\"h-8 w-8 text-purple-600\" />\n                <SparklesIcon className=\"absolute -top-1 -right-1 h-4 w-4 text-yellow-500\" />\n              </div>\n              <div>\n                <h1 className=\"text-2xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent\">\n                  Astrology Platform\n                </h1>\n                <p className=\"text-sm text-muted-foreground\">\n                  Professional-grade birth chart calculations with Swiss Ephemeris accuracy\n                </p>\n              </div>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <Badge variant=\"cosmic\">Swiss Ephemeris</Badge>\n              <Badge variant=\"outline\">Professional</Badge>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"container mx-auto px-4 py-8\">\n        {!birthChart ? (\n          /* Birth Data Collection */\n          <div className=\"space-y-8\">\n            {/* Hero Section */}\n            <div className=\"text-center space-y-4\">\n              <div className=\"flex justify-center space-x-4 mb-6\">\n                <SunIcon className=\"h-12 w-12 text-yellow-500 animate-pulse\" />\n                <MoonIcon className=\"h-12 w-12 text-blue-400 animate-pulse\" style={{ animationDelay: '0.5s' }} />\n                <StarIcon className=\"h-12 w-12 text-purple-500 animate-pulse\" style={{ animationDelay: '1s' }} />\n              </div>\n              <h2 className=\"text-4xl font-bold bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 bg-clip-text text-transparent\">\n                Discover Your Cosmic Blueprint\n              </h2>\n              <p className=\"text-xl text-muted-foreground max-w-2xl mx-auto\">\n                Generate your professional birth chart with Swiss Ephemeris precision. \n                Explore planetary positions, houses, and aspects with stunning visualizations.\n              </p>\n            </div>\n\n            {/* Features Grid */}\n            <div className=\"grid md:grid-cols-3 gap-6 mb-8\">\n              <Card className=\"text-center\">\n                <CardHeader>\n                  <div className=\"mx-auto w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center mb-2\">\n                    <StarIcon className=\"h-6 w-6 text-purple-600\" />\n                  </div>\n                  <CardTitle className=\"text-lg\">Swiss Ephemeris Accuracy</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Professional-grade astronomical calculations with sub-arcsecond precision, \n                    matching the accuracy of leading astrology software.\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card className=\"text-center\">\n                <CardHeader>\n                  <div className=\"mx-auto w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mb-2\">\n                    <SparklesIcon className=\"h-6 w-6 text-blue-600\" />\n                  </div>\n                  <CardTitle className=\"text-lg\">Interactive Visualizations</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Beautiful, interactive birth chart wheels with clickable planets, \n                    aspect lines, and detailed information panels.\n                  </p>\n                </CardContent>\n              </Card>\n\n              <Card className=\"text-center\">\n                <CardHeader>\n                  <div className=\"mx-auto w-12 h-12 bg-indigo-100 dark:bg-indigo-900 rounded-full flex items-center justify-center mb-2\">\n                    <MoonIcon className=\"h-6 w-6 text-indigo-600\" />\n                  </div>\n                  <CardTitle className=\"text-lg\">Comprehensive Analysis</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Complete planetary positions, house cusps, aspects, and angles \n                    with detailed interpretations and insights.\n                  </p>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Birth Data Form */}\n            <BirthDataForm \n              onSubmit={handleBirthDataSubmit}\n              isLoading={isCalculating}\n            />\n\n            {/* Error Display */}\n            {error && (\n              <Card className=\"border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-900/20\">\n                <CardContent className=\"pt-6\">\n                  <div className=\"flex items-center space-x-2\">\n                    <div className=\"w-4 h-4 bg-red-500 rounded-full\" />\n                    <p className=\"text-red-700 dark:text-red-300 font-medium\">Calculation Error</p>\n                  </div>\n                  <p className=\"text-red-600 dark:text-red-400 mt-2\">{error}</p>\n                  <Button \n                    variant=\"outline\" \n                    size=\"sm\" \n                    className=\"mt-4\"\n                    onClick={() => setError(null)}\n                  >\n                    Try Again\n                  </Button>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        ) : (\n          /* Birth Chart Display */\n          <div className=\"space-y-8\">\n            {/* Chart Header */}\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h2 className=\"text-3xl font-bold\">\n                  {birthChart.birthData.name ? `${birthChart.birthData.name}'s Birth Chart` : 'Birth Chart'}\n                </h2>\n                <div className=\"flex items-center space-x-4 mt-2 text-muted-foreground\">\n                  <div className=\"flex items-center space-x-1\">\n                    <CalendarIcon className=\"h-4 w-4\" />\n                    <span>{birthChart.birthData.date.toLocaleDateString()}</span>\n                  </div>\n                  <div className=\"flex items-center space-x-1\">\n                    <ClockIcon className=\"h-4 w-4\" />\n                    <span>\n                      {birthChart.birthData.time.hour.toString().padStart(2, '0')}:\n                      {birthChart.birthData.time.minute.toString().padStart(2, '0')}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center space-x-1\">\n                    <MapPinIcon className=\"h-4 w-4\" />\n                    <span>\n                      {birthChart.birthData.location.city}, {birthChart.birthData.location.country}\n                    </span>\n                  </div>\n                </div>\n              </div>\n              <Button variant=\"outline\" onClick={resetChart}>\n                New Chart\n              </Button>\n            </div>\n\n            {/* Chart Tabs */}\n            <Tabs defaultValue=\"chart\" className=\"space-y-6\">\n              <TabsList className=\"grid w-full grid-cols-4\">\n                <TabsTrigger value=\"chart\">Birth Chart</TabsTrigger>\n                <TabsTrigger value=\"planets\">Planets</TabsTrigger>\n                <TabsTrigger value=\"houses\">Houses</TabsTrigger>\n                <TabsTrigger value=\"aspects\">Aspects</TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"chart\" className=\"space-y-6\">\n                <BirthChartWheel \n                  chart={birthChart}\n                  size={500}\n                  theme=\"cosmic\"\n                  showAspects={true}\n                  showHouseNumbers={true}\n                />\n              </TabsContent>\n\n              <TabsContent value=\"planets\" className=\"space-y-6\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle>Planetary Positions</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid gap-4\">\n                      {birthChart.planets.map((planet) => (\n                        <div key={planet.planet} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                          <div className=\"flex items-center space-x-3\">\n                            <span \n                              className=\"text-xl\"\n                              style={{ color: planet.planet in PLANET_INFO ? PLANET_INFO[planet.planet as keyof typeof PLANET_INFO].color : '#666' }}\n                            >\n                              {planet.planet in PLANET_INFO ? PLANET_INFO[planet.planet as keyof typeof PLANET_INFO].symbol : '?'}\n                            </span>\n                            <div>\n                              <div className=\"font-medium capitalize\">{planet.planet}</div>\n                              <div className=\"text-sm text-muted-foreground\">\n                                {planet.degree}°{planet.minute.toString().padStart(2, '0')}' {planet.sign}\n                              </div>\n                            </div>\n                          </div>\n                          <div className=\"text-right\">\n                            <div className=\"text-sm font-medium\">\n                              House {planet.house || '?'}\n                            </div>\n                            {planet.retrograde && (\n                              <Badge variant=\"destructive\" className=\"text-xs\">\n                                Retrograde\n                              </Badge>\n                            )}\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"houses\" className=\"space-y-6\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle>House Cusps</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid gap-3\">\n                      {birthChart.houses.map((house) => (\n                        <div key={house.house} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                          <div className=\"font-medium\">\n                            {house.house}{getOrdinalSuffix(house.house)} House\n                          </div>\n                          <div className=\"text-right\">\n                            <div className=\"font-medium\">\n                              {house.degree}°{house.minute.toString().padStart(2, '0')}' {house.sign}\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"aspects\" className=\"space-y-6\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle>Planetary Aspects</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid gap-3\">\n                      {birthChart.aspects.map((aspect, index) => (\n                        <div key={index} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                          <div className=\"flex items-center space-x-3\">\n                            <div className=\"flex items-center space-x-1\">\n                              <span className=\"capitalize font-medium\">{aspect.planet1}</span>\n                              <span className=\"text-muted-foreground\">{getAspectSymbol(aspect.type)}</span>\n                              <span className=\"capitalize font-medium\">{aspect.planet2}</span>\n                            </div>\n                          </div>\n                          <div className=\"text-right\">\n                            <div className=\"font-medium capitalize\">{aspect.type}</div>\n                            <div className=\"text-sm text-muted-foreground\">\n                              Orb: {aspect.orb.toFixed(2)}°\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n            </Tabs>\n          </div>\n        )}\n      </main>\n\n      {/* Footer */}\n      <footer className=\"border-t bg-white/80 backdrop-blur-sm dark:bg-gray-900/80 mt-16\">\n        <div className=\"container mx-auto px-4 py-8\">\n          <div className=\"text-center text-muted-foreground\">\n            <p className=\"text-sm\">\n              Powered by Swiss Ephemeris • Professional Astrology Platform • \n              Built with Next.js, TypeScript, and shadcn/ui\n            </p>\n          </div>\n        </div>\n      </footer>\n    </div>\n  )\n}\n\n// Helper functions\nfunction getOrdinalSuffix(num: number): string {\n  const j = num % 10\n  const k = num % 100\n  if (j === 1 && k !== 11) return 'st'\n  if (j === 2 && k !== 12) return 'nd'\n  if (j === 3 && k !== 13) return 'rd'\n  return 'th'\n}\n\nfunction getAspectSymbol(aspectType: string): string {\n  switch (aspectType) {\n    case 'conjunction': return '☌'\n    case 'opposition': return '☍'\n    case 'trine': return '△'\n    case 'square': return '□'\n    case 'sextile': return '⚹'\n    case 'quincunx': return '⚻'\n    default: return '•'\n  }\n}\n\n// Import PLANET_INFO for the component\nimport { PLANET_INFO } from '@/types/astrology'